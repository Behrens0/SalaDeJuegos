import{a as N}from"./chunk-NWFSGMAH.js";import"./chunk-LJ5XHLMQ.js";import{C as f,F as c,H as r,I as a,J as M,K as y,L as S,M as h,N as P,R as s,S as T,T as j,U as w,ha as I,i as l,ia as E,ka as k,m as x,n as v,t as C,ta as b,v as i,x as _,y as O,z as u}from"./chunk-CB2OHQ7B.js";import{h as p}from"./chunk-FK42CRUA.js";function R(n,t){if(n&1&&(r(0,"div",9),M(1,"img",10),a()),n&2){let e=h();i(),P("alt","Imagen de ",e.personajeActual.fullName,""),c("src",e.personajeActual.imageUrl,C)}}function z(n,t){if(n&1){let e=y();r(0,"button",11),S("click",function(){let m=x(e).$implicit,A=h();return v(A.seleccionar(m))}),s(1),a()}if(n&2){let e=t.$implicit;i(),j(" ",e," ")}}function D(n,t){if(n&1&&(r(0,"li"),s(1),a()),n&2){let e=t.$implicit;i(),w(" ",e.nombre," - ",e.puntaje," puntos ")}}var g=class n{constructor(t){this.supabaseService=t}personajes=[];personajeActual=null;opciones=[];puntaje=0;mensaje="";mejoresJugadores=[];ngOnInit(){this.cargarPersonajes(),this.obtenerRanking()}cargarPersonajes(){return p(this,null,function*(){try{let t=yield fetch("https://thronesapi.com/api/v2/Characters");this.personajes=yield t.json(),this.nuevaPregunta()}catch(t){console.error("Error al cargar personajes:",t),this.mensaje="No se pudo cargar los personajes"}})}nuevaPregunta(){if(this.personajes.length<4)return;let t=this.personajes[Math.floor(Math.random()*this.personajes.length)];this.personajeActual=t;let e=new Set;for(e.add(t.fullName);e.size<4;){let o=this.personajes[Math.floor(Math.random()*this.personajes.length)];e.add(o.fullName)}this.opciones=this.mezclar(Array.from(e))}mezclar(t){return t.sort(()=>Math.random()-.5)}guardarPuntaje(){return p(this,null,function*(){let{data:t,error:e}=yield this.supabaseService.getUser(),o=t?.user?.email||"An\xF3nimo",{error:m}=yield this.supabaseService.insertPuntajeThrones(this.puntaje);m?(console.error("Error al guardar puntaje:",m.message),this.mensaje="Error al guardar el puntaje. Intenta nuevamente."):this.obtenerRanking()})}obtenerRanking(){return p(this,null,function*(){let{data:t,error:e}=yield this.supabaseService.getTopThronesRanking(5);e?(console.error("Error al obtener ranking:",e.message),this.mensaje="Error al obtener el ranking"):this.mejoresJugadores=t.map(o=>({nombre:o.correo,puntaje:o.puntaje}))})}seleccionar(t){return p(this,null,function*(){t===this.personajeActual.fullName?(this.puntaje++,this.mensaje="\xA1Correcto! Puntaje: "+this.puntaje):(this.mensaje=`Incorrecto. Era: ${this.personajeActual.fullName}`,yield this.guardarPuntaje(),this.puntaje=0),setTimeout(()=>{this.mensaje="",this.nuevaPregunta()},1e3)})}static \u0275fac=function(e){return new(e||n)(_(N))};static \u0275cmp=O({type:n,selectors:[["app-game-of-thrones"]],standalone:!1,decls:15,vars:5,consts:[[1,"preguntados-container"],["class","categoria-info",4,"ngIf"],[1,"pregunta"],[1,"respuestas-container"],["class","respuesta-btn",3,"click",4,"ngFor","ngForOf"],[1,"puntos"],[1,"mensaje"],[1,"ranking-container"],[4,"ngFor","ngForOf"],[1,"categoria-info"],[1,"categoria-imagen",3,"src","alt"],[1,"respuesta-btn",3,"click"]],template:function(e,o){e&1&&(r(0,"div",0),f(1,R,2,3,"div",1),r(2,"h2",2),s(3,"\xBFC\xF3mo se llama este personaje?"),a(),r(4,"div",3),f(5,z,2,1,"button",4),a(),r(6,"p",5),s(7),a(),r(8,"p",6),s(9),a(),r(10,"div",7)(11,"h3"),s(12,"TOP 5:"),a(),r(13,"ul"),f(14,D,2,2,"li",8),a()()()),e&2&&(i(),c("ngIf",o.personajeActual),i(4),c("ngForOf",o.opciones),i(2),j("Puntaje: ",o.puntaje,""),i(2),T(o.mensaje),i(5),c("ngForOf",o.mejoresJugadores))},dependencies:[I,E],styles:[".preguntados-container[_ngcontent-%COMP%]{text-align:center;max-width:900px;margin:150px auto;padding:20px;border:2px solid #007bff;border-radius:10px;background-color:#f9f9f9;font-family:Roboto,sans-serif}.pregunta[_ngcontent-%COMP%]{font-size:24px;font-weight:700;margin-bottom:20px}.respuestas-container[_ngcontent-%COMP%]{margin-top:20px}.respuesta-btn[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;padding:10px 20px;border:none;border-radius:5px;cursor:pointer;margin:5px}.respuesta-btn[_ngcontent-%COMP%]:hover{background-color:#0056b3}.puntos[_ngcontent-%COMP%]{margin-top:20px;font-size:18px;font-weight:700}.mensaje[_ngcontent-%COMP%]{margin-top:20px;font-size:20px;color:#d9534f}.categoria[_ngcontent-%COMP%]{font-size:20px;margin-bottom:20px;color:#4caf50}.categoria-imagen[_ngcontent-%COMP%]{width:300px;height:300px;object-fit:contain;border-radius:10px;border:2px solid #ccc}"]})};var U=[{path:"",component:g}],d=class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=u({type:n});static \u0275inj=l({imports:[b.forChild(U),b]})};var G=class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=u({type:n});static \u0275inj=l({imports:[k,d]})};export{G as GameOfThronesModule};
