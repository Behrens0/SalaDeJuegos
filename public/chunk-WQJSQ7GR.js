import{a as F}from"./chunk-NWFSGMAH.js";import"./chunk-LJ5XHLMQ.js";import{$ as P,C as u,F as f,H as e,I as t,R as o,S as m,T as _,aa as M,ha as E,i as C,ja as I,ka as R,ta as j,v as r,x as S,y as O,z as y}from"./chunk-CB2OHQ7B.js";import{h as v}from"./chunk-FK42CRUA.js";function D(a,i){if(a&1&&(e(0,"tr")(1,"td"),o(2),t(),e(3,"td"),o(4),t(),e(5,"td"),o(6),t(),e(7,"td"),o(8),P(9,"date"),t()()),a&2){let n=i.$implicit,s=i.index;r(2),_("#",s+1,""),r(2),m(n.correo),r(2),m(n.puntos),r(2),m(M(9,4,n.fecha,"short"))}}function z(a,i){if(a&1&&(e(0,"div",7)(1,"h2",4),o(2),t(),e(3,"table",5)(4,"thead")(5,"tr")(6,"th"),o(7,"Puesto"),t(),e(8,"th"),o(9,"Correo"),t(),e(10,"th"),o(11,"Puntos"),t(),e(12,"th"),o(13,"Fecha"),t()()(),e(14,"tbody"),u(15,D,10,7,"tr",6),t()()()),a&2){let n=i.$implicit;r(2),m(n.titulo),r(13),f("ngForOf",n.datos)}}function A(a,i){if(a&1&&(e(0,"tr")(1,"td"),o(2),t(),e(3,"td"),o(4),t(),e(5,"td"),o(6),t()()),a&2){let n=i.$implicit,s=i.index;r(2),_("#",s+1,""),r(2),m(n.correo),r(2),m(n.puntos)}}var b=class a{constructor(i){this.supabaseService=i}rankingsPorJuego=[];rankingGeneral=[];ngOnInit(){return v(this,null,function*(){let i=[{tabla:"ranking",campo:"score"},{tabla:"ranking_mayor_menor",campo:"score"},{tabla:"ranking_preguntados",campo:"puntaje"},{tabla:"ranking_thrones",campo:"puntaje"}],n=[];for(let{tabla:l,campo:c}of i){let h=`correo, ${c}, fecha`,{data:w,error:k}=yield this.supabaseService.supabase.from(l).select(h);if(k){console.error(`Error en ${l}:`,k);continue}let p={};for(let g of w){let d=g.correo,x=parseInt(g[c]??"0",10),N=g.fecha??"-";(!p[d]||x>p[d].puntos)&&(p[d]={correo:d,puntos:x,fecha:N})}let G=Object.values(p).sort((g,d)=>d.puntos-g.puntos).slice(0,5),J=l==="ranking"?"Ahorcado":l==="ranking_mayor_menor"?"Mayor/Menor":l==="ranking_preguntados"?"Preguntados":"Thrones";this.rankingsPorJuego.push({titulo:J,datos:G}),n.push(...Object.values(p))}let s={};for(let l of n){let{correo:c,puntos:h}=l;s[c]||(s[c]={correo:c,puntos:0}),s[c].puntos+=h}this.rankingGeneral=Object.values(s).sort((l,c)=>c.puntos-l.puntos).slice(0,5)})}static \u0275fac=function(n){return new(n||a)(S(F))};static \u0275cmp=O({type:a,selectors:[["app-ranking-general"]],standalone:!1,decls:18,vars:2,consts:[[1,"contenedor"],[1,"titulo"],["class","ranking-juego",4,"ngFor","ngForOf"],[1,"ranking-general"],[1,"subtitulo"],[1,"tabla"],[4,"ngFor","ngForOf"],[1,"ranking-juego"]],template:function(n,s){n&1&&(e(0,"div",0)(1,"h1",1),o(2,"Ranking General de Juegos"),t(),u(3,z,16,2,"div",2),e(4,"div",3)(5,"h2",4),o(6,"Ranking General"),t(),e(7,"table",5)(8,"thead")(9,"tr")(10,"th"),o(11,"Puesto"),t(),e(12,"th"),o(13,"Correo"),t(),e(14,"th"),o(15,"Total Puntos"),t()()(),e(16,"tbody"),u(17,A,7,3,"tr",6),t()()()()),n&2&&(r(3),f("ngForOf",s.rankingsPorJuego),r(14),f("ngForOf",s.rankingGeneral))},dependencies:[E,I],styles:[".contenedor[_ngcontent-%COMP%]{padding:2rem;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;background-color:#f9f9f9;color:#333}.titulo[_ngcontent-%COMP%]{text-align:center;margin-bottom:2rem;font-size:2rem;color:#2e7d32}.subtitulo[_ngcontent-%COMP%]{margin-top:2rem;margin-bottom:1rem;color:#388e3c;font-size:1.5rem}.tabla[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-bottom:1rem;background-color:#fff;border-radius:10px;overflow:hidden;box-shadow:0 2px 6px #0000001a}.tabla[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .tabla[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem 1rem;text-align:left;border-bottom:1px solid #ddd}.tabla[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#e8f5e9;color:#2e7d32;font-weight:700}.tabla[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%]{border-bottom:none}.ranking-general[_ngcontent-%COMP%]{margin-top:3rem}"]})};var B=[{path:"",component:b}],T=class a{static \u0275fac=function(n){return new(n||a)};static \u0275mod=y({type:a});static \u0275inj=C({imports:[R,j.forChild(B)]})};export{T as RankingsModule};
